"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.canUseWorkspacePlanFeature = void 0;
const result_1 = require("true-myth/result");
const workspaces_js_1 = require("../../fragments/workspaces.js");
/**
 * TODO: Refactor. Just use the fragment if you want to check if a workspace has access to a feature,
 * and create more specific policies for the actual use cases, cause policies shouldn't be reusable
 * building blocks like this.
 */
const canUseWorkspacePlanFeature = (loaders) => async ({ userId, workspaceId, feature }) => {
    const isWorkspaceAdmin = await (0, workspaces_js_1.ensureUserIsWorkspaceAdminFragment)(loaders)({
        userId,
        workspaceId
    });
    if (isWorkspaceAdmin.isErr)
        return (0, result_1.err)(isWorkspaceAdmin.error);
    const canUseFeature = await (0, workspaces_js_1.ensureCanUseWorkspacePlanFeatureFragment)(loaders)({
        workspaceId,
        feature
    });
    if (canUseFeature.isErr)
        return (0, result_1.err)(canUseFeature.error);
    return (0, result_1.ok)();
};
exports.canUseWorkspacePlanFeature = canUseWorkspacePlanFeature;
//# sourceMappingURL=canUseWorkspacePlanFeature.js.map